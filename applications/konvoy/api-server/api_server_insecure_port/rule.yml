documentation_complete: true

prodtype: konvoy5

title: 'Prevent Insecure Port Access'

description: |-
    By default, traffic for the Konvoy API server is served over
    HTTPS with authentication and authorization, and the secure API endpoint
    is bound to 0.0.0.0:8443. To ensure that the insecure port configuration
    has not been enabled, the <tt>insecure-port</tt> setting should not exist
{{%- if product == "konvoy5" %}}
    in <tt>/etc/kubernetes/manifests/kube-apiserver.yaml</tt> on the master node(s).
{{%- endif %}}

rationale: |-
    Configuring the API Server on an insecure port would allow unauthenticated
    and unencrypted access to your master node(s). It is assumed firewall rules
    will be configured to ensure this port is not reachable from outside
    the cluster, however as a defense in depth measure, Konvoy should not
    be configured to use insecure ports.

severity: medium

references:
    cis: 1.2.19

ocil_clause: '<tt>insecure-port</tt> setting exists'

ocil: |-
    Run the following command on the master node(s):
{{%- if product == "konvoy5" %}}
    <pre>$ sudo grep -A2 insecure-port /etc/kubernetes/manifests/kube-apiserver.yaml</pre>
{{%- endif %}}
    There should be no output returned.
